(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-62588bc4"],{"0eca":function(e,t,n){},"1c4a":function(e,t,n){"use strict";n("e8d5")},"39e8":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"sys-menu-container"},[n("table-layout",{staticClass:"table-layout",scopedSlots:e._u([{key:"headerLeft",fn:function(){return[n("el-button",{attrs:{size:"mini",type:"primary"},on:{click:e.handleAdd}},[e._v("新增")])]},proxy:!0},{key:"headerRight",fn:function(){return[n("el-button",{attrs:{size:"mini",icon:"el-icon-refresh"},on:{click:e.handleRefresh}})]},proxy:!0}])},[[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,size:"small","header-cell-style":{backgroundColor:"#ebeef4"},border:"",fit:"","highlight-current-row":"","row-key":"id","tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"row-click":e.handleRowClick}},[n("el-table-column",{attrs:{prop:"name",label:"名称",width:"240"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticStyle:{"margin-right":"16px"}},[e._v(e._s(t.row.name))]),t.row.isHidden?n("el-tag",{attrs:{type:"danger",effect:"dark",size:"small"}},[e._v("隐藏")]):e._e()]}}])}),n("el-table-column",{attrs:{prop:"icon",label:"图标",width:"60",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.icon?n("svg-icon",{attrs:{"icon-class":t.row.icon}}):e._e()]}}])}),n("el-table-column",{attrs:{prop:"type",label:"类型",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-tag",{attrs:{size:"small",effect:"dark"}},[e._v(e._s(e.getMenuType(t.row.type)))])]}}])}),n("el-table-column",{attrs:{prop:"router",label:"节点路由",align:"center",width:"240"}}),n("el-table-column",{attrs:{prop:"keepalive",label:"路由缓存",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.keepalive&&1===t.row.type?n("i",{staticClass:"el-icon-check"}):e._e()]}}])}),n("el-table-column",{attrs:{prop:"viewPath",label:"文件路径",align:"center",width:"280"}}),n("el-table-column",{attrs:{prop:"orderNum",label:"排序号",width:"80",align:"center"}}),n("el-table-column",{attrs:{prop:"updateTime",label:"更新时间",width:"180",align:"center"}}),n("el-table-column",{attrs:{label:"操作",width:"150",align:"center",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{size:"mini",type:"text"},on:{click:function(n){return n.stopPropagation(),e.handleEdit(t.row)}}},[e._v("编辑")]),n("warning-confirm-button",{attrs:{closed:e.handleRefresh},on:{confirm:function(n){e.handleDelete(t.row,n)}}},[e._v("删除")])]}}])})],1)]],2),n("menu-form-dialog",{ref:"formDialog",attrs:{"form-id":e.formId,menutree:e.menutree},on:{"save-success":e.handleRefresh},model:{value:e.dialogVisible,callback:function(t){e.dialogVisible=t},expression:"dialogVisible"}})],1)},a=[],i=n("1da1"),o=(n("96cf"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-dialog",{attrs:{title:e.title,width:"50%","close-on-click-modal":!1,"append-to-body":!0,center:!0,visible:e.visible},on:{"update:visible":function(t){e.visible=t},open:e.open,close:e.close,closed:e.closed}},[n("el-form",{ref:"form",attrs:{"label-position":"right",model:e.form,rules:e.rules}},[n("el-form-item",{attrs:{label:"菜单类型","label-width":e.labelWidth,prop:"type"}},[n("el-radio",{attrs:{label:"directory"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("目录")]),n("el-radio",{attrs:{label:"menu"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[e._v("菜单")])],1),n("el-form-item",{attrs:{label:"上级节点","label-width":e.labelWidth,prop:"parentId"}},[n("el-popover",{attrs:{placement:"bottom-start",width:"300",trigger:"click"},model:{value:e.popoverVisible,callback:function(t){e.popoverVisible=t},expression:"popoverVisible"}},[n("el-scrollbar",{attrs:{"wrap-style":"max-height: 300px;"}},[n("el-tree",{attrs:{"node-key":"id","expand-on-click-node":!1,data:e.menus,props:{children:"children",label:"label"}},on:{"node-click":e.handleMenuNodeClick}})],1),n("el-input",{attrs:{slot:"reference",placeholder:"请选择上级节点",readonly:""},slot:"reference",model:{value:e.form.parentName,callback:function(t){e.$set(e.form,"parentName",t)},expression:"form.parentName"}})],1)],1),n("el-form-item",{attrs:{label:"节点名称","label-width":e.labelWidth,prop:"name"}},[n("el-input",{attrs:{autocomplete:"off"},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),n("el-form-item",{attrs:{label:"节点路由","label-width":e.labelWidth,prop:"router"}},[n("el-input",{attrs:{autocomplete:"off",placeholder:"例：/system/power/menu"},model:{value:e.form.router,callback:function(t){e.$set(e.form,"router",t)},expression:"form.router"}})],1),n("el-form-item",{attrs:{label:"节点图标","label-width":e.labelWidth,prop:"icon"}},[n("el-popover",{attrs:{placement:"bottom-start",width:"700",trigger:"click"},model:{value:e.popoverVisibleIcon,callback:function(t){e.popoverVisibleIcon=t},expression:"popoverVisibleIcon"}},[n("el-scrollbar",{attrs:{"wrap-style":"max-height: 300px;"}},[n("icon-selector",{attrs:{value:e.form.icon},on:{selected:e.iconSelected}})],1),n("el-input",{attrs:{slot:"reference",placeholder:"请选择图标",readonly:""},slot:"reference",model:{value:e.form.icon,callback:function(t){e.$set(e.form,"icon",t)},expression:"form.icon"}},[e.form.icon?n("svg-icon",{attrs:{slot:"prefix","icon-class":e.form.icon},slot:"prefix"}):n("span",{attrs:{slot:"prefix"},slot:"prefix"})],1)],1)],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"menu"===e.form.type,expression:"form.type === 'menu'"}],attrs:{label:"隐藏","label-width":e.labelWidth,prop:"isHidden"}},[n("el-switch",{model:{value:e.form.isHidden,callback:function(t){e.$set(e.form,"isHidden",t)},expression:"form.isHidden"}})],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"menu"===e.form.type,expression:"form.type === 'menu'"}],attrs:{label:"是否缓存","label-width":e.labelWidth,prop:"keepalive"}},[n("el-switch",{model:{value:e.form.keepalive,callback:function(t){e.$set(e.form,"keepalive",t)},expression:"form.keepalive"}})],1),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"menu"===e.form.type,expression:"form.type === 'menu'"}],attrs:{label:"文件路径","label-width":e.labelWidth}},[n("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择文件路径"},model:{value:e.form.viewPath,callback:function(t){e.$set(e.form,"viewPath",t)},expression:"form.viewPath"}},e._l(e.getViewFiles(),(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{on:{click:e.close}},[e._v("取 消")]),n("el-button",{attrs:{type:"primary",loading:e.saving},on:{click:e.submit}},[e._v("确 定")])],1)],1)}),l=[],s=(n("b0c0"),n("b64b"),n("2ef0")),c=n.n(s),u=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"icon-body"},[n("div",{staticClass:"icon-list"},e._l(e.svgIcons,(function(t,r){return n("div",{key:r,on:{click:function(n){return e.handleSelectChange(t)}}},[n("svg-icon",{staticStyle:{height:"30px",width:"16px"},attrs:{"icon-class":t}}),n("span",[e._v(e._s(t))])],1)})),0)])},d=[],f=(n("d3b7"),n("ddb0"),n("d81d"),n("ac1f"),n("466d"),n("51ff")),p=function(e){return e.keys()},m=/\.\/(.*)\.svg/,h=p(f).map((function(e){return e.match(m)[1]})),b={name:"IconSelector",props:{value:{type:String,default:""}},data:function(){return{svgIcons:h}},methods:{handleSelectChange:function(e){this.$emit("selected",e)}}},v=b,g=(n("1c4a"),n("2877")),y=Object(g["a"])(v,u,d,!1,null,"44a7dc7c",null),w=y.exports,k=n("a18c"),x=n("dde5"),_={components:{IconSelector:w},model:{prop:"dialogVisible",event:"close"},props:{menutree:{type:Array,required:!0},dialogVisible:{type:Boolean,required:!0},formId:{type:String,default:"-1"}},data:function(){return{labelWidth:"100px",defaultForm:null,form:{id:"-1",parentId:null,parentName:null,name:null,router:null,type:"directory",icon:null,orderNum:0,viewPath:null,keepalive:!1,isHidden:!1},rules:{name:[{required:!0,message:"必填",trigger:"blur"}],parentId:[{required:!0,message:"必填",trigger:"input"}],router:[{required:!0,message:"必填",trigger:"blur"}]},loading:!1,saving:!1,popoverVisible:!1,popoverVisibleIcon:!1}},computed:{visible:{get:function(){return this.dialogVisible},set:function(){this.$emit("close",!1)}},title:function(){return"-1"===this.form.id?"添加菜单":"编辑菜单"},menus:function(){return this.menutree}},created:function(){this.defaultForm=c.a.cloneDeep(this.form)},destroyed:function(){this.defaultForm=null},methods:{open:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.init();case 2:if("-1"!==e.form.id){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,e.setData();case 6:case"end":return t.stop()}}),t)})))()},init:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.form.id=e.formId;case 1:case"end":return t.stop()}}),t)})))()},setData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,x["k"].getMenuAndParentMenu({id:e.form.id});case 3:n=t.sent,r=n.data.data,a=r.menu,i=r.parentMenu,e.form.parentId=i?a.parentId:"-1",e.form.parentName=i?i.name:"一级菜单",e.form.name=a.name,e.form.router=a.router,e.form.type=a.type,e.form.icon=a.icon,e.form.orderNum=a.orderNum,e.form.viewPath=a.viewPath,e.form.keepalive=a.keepalive,e.form.isHidden=a.isHidden,t.next=23;break;case 18:t.prev=18,t.t0=t["catch"](0),console.error("menu.getMenuAndParentMenu-error:",t.t0),o=t.t0&&t.t0.data.message||"发生了一些未知的错误，请重试！",e.$message.error(o);case 23:case"end":return t.stop()}}),t,null,[[0,18]])})))()},close:function(){this.visible=!1,this.saving=!1,this.loading=!1,this.clearValidate()},closed:function(){this.form=c.a.cloneDeep(this.defaultForm)},done:function(){this.saving=!1},validate:function(e){this.$refs.form&&this.$refs.form.validate(e)},resetFields:function(){this.$refs.form&&this.$refs.form.resetFields()},clearValidate:function(e){this.$refs.form&&this.$refs.form.clearValidate(e)},submit:function(){var e=this;this.$refs.form.validate(function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(n){var r,a,i,o;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!n){t.next=26;break}if(e.saving=!0,r=c.a.cloneDeep(e.form),a=null,t.prev=4,"-1"!==r.id){t.next=11;break}return t.next=8,x["k"].createMenu(r);case 8:a=t.sent,t.next=14;break;case 11:return t.next=13,x["k"].updateMenu(r);case 13:a=t.sent;case 14:i=a.data.data,console.log(i),e.$emit("save-success"),e.close(),t.next=26;break;case 20:t.prev=20,t.t0=t["catch"](4),console.error("menu.submitMenu-error:",t.t0),e.done(),o=t.t0&&t.t0.data.message||"发生了一些未知的错误，请重试！",e.$message.error(o);case 26:case"end":return t.stop()}}),t,null,[[4,20]])})));return function(e){return t.apply(this,arguments)}}())},iconSelected:function(e){this.form.icon=e,this.popoverVisibleIcon=!1},handleMenuNodeClick:function(e){var t=e.id,n=e.label;this.form.parentId=t,this.form.parentName=n,this.popoverVisible=!1},getViewFiles:function(){return Object.keys(k["b"])}}},T=_,$=Object(g["a"])(T,o,l,!1,null,null,null),S=$.exports,I=n("fe2b"),M=n("7ec7"),C=n("fbbc"),V={name:"SystemPowerMenu",components:{MenuFormDialog:S,TableLayout:C["a"],WarningConfirmButton:I["a"]},mixins:[M["a"]],data:function(){return{tableData:[],tableLoading:!1,tablePagination:{total:0,pageSize:10,currentPage:1},tableSearchParams:{name:""},tableMultipleSelection:[],dialogVisible:!1,formId:"-1",menutree:[]}},created:function(){this.loadTableData()},methods:{loadTableData:function(){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function t(){var n,r,a,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.tableLoading=!0,t.prev=1,t.next=4,x["k"].getMenuList();case 4:n=t.sent,r=n.data.data,e.menutree&&e.menutree.length>0&&(e.menutree=[]),a={id:"-1",label:"一级菜单"},a.children=e.filterMenuToTree(r,null),e.menutree.push(a),e.tableData=e.filterMenuToTable(r,null),e.tableLoading=!1,t.next=20;break;case 14:t.prev=14,t.t0=t["catch"](1),console.error("menu.getMenuList-error:",t.t0),e.tableLoading=!1,i=t.t0&&t.t0.data.message||"发生了一些未知的错误，请重试！",e.$message.error(i);case 20:case"end":return t.stop()}}),t,null,[[1,14]])})))()},handleRefresh:function(){this.loadTableData()},handleAdd:function(){this.formId="-1",this.dialogVisible=!0},handleEdit:function(e){this.formId=e.id,this.dialogVisible=!0},handleDelete:function(e,t){var n=this;return Object(i["a"])(regeneratorRuntime.mark((function r(){var a,i,o;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=t.done,i=t.close,r.prev=1,r.next=4,x["k"].deleteMenu({ids:[e.id]});case 4:i(),r.next=13;break;case 7:r.prev=7,r.t0=r["catch"](1),console.error("role.deleteRole-error:",r.t0),a(),o=r.t0&&r.t0.data.message||"发生了一些未知的错误，请重试！",n.$message.error(o);case 13:case"end":return r.stop()}}),r,null,[[1,7]])})))()},getMenuType:function(e){switch(e){case"directory":return"目录";case"menu":return"菜单"}},handleRowClick:function(e){this.$refs.table.toggleRowExpansion(e)}}},R=V,O=(n("3d6c"),Object(g["a"])(R,r,a,!1,null,"3d2c2130",null));t["default"]=O.exports},"3d6c":function(e,t,n){"use strict";n("dc20")},"7ec7":function(e,t,n){"use strict";var r=n("5530");n("159b"),n("b0c0");t["a"]={methods:{filterMenuToTable:function(e,t){var n=this,a=[];return e.forEach((function(i){var o;if(t||i.parentId||"menu"!==i.type)if(t||i.parentId||"directory"!==i.type){if(t&&t.id===i.parentId&&"menu"===i.type){var l=n.filterMenuToTable(e,i);o=Object(r["a"])({},i),o.children=l}else if(t&&t.id===i.parentId&&"directory"===i.type){var s=n.filterMenuToTable(e,i);o=Object(r["a"])({},i),o.children=s}}else{var c=n.filterMenuToTable(e,i);o=Object(r["a"])({},i),o.children=c}else{var u=n.filterMenuToTable(e,i);o=Object(r["a"])({},i),o.children=u}o&&(o.pid=i.id,a.push(o))})),a},filterMenuToTree:function(e,t){var n=this,r=[];return e.forEach((function(a){var i;if(t||a.parentId||"menu"!==a.type)if(t||a.parentId||"directory"!==a.type){if(t&&t.id===a.parentId&&"menu"===a.type)i={label:a.name};else if(t&&t.id===a.parentId&&"directory"===a.type){var o=n.filterMenuToTree(e,a);i={label:a.name},i.children=o}}else{var l=n.filterMenuToTree(e,a);i={label:a.name},i.children=l}else i={label:a.name};i&&(i.id=a.id,r.push(i))})),r}}}},ce8d:function(e,t,n){"use strict";n("0eca")},dc20:function(e,t,n){},e8d5:function(e,t,n){},fbbc:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{style:{border:"none",margin:"20px"}},[n("el-container",{class:{"fixed-height":!e.wrap}},[e.$slots.asside?n("el-aside",{attrs:{width:e.assideWidth}},[e._t("asside")],2):e._e(),n("el-container",[n("el-main",[n("div",{staticClass:"table-container"},[n("div",{staticClass:"table-layout-header"},[n("div",{staticClass:"left"},[e._t("headerLeft")],2),n("div",{staticClass:"right"},[e._t("headerRight")],2)]),n("div",{staticClass:"table-layout-content",class:{"fixed-table-height":!e.wrap}},[e._t("default")],2),e.$slots.pagination?n("div",{staticClass:"table-layout-pagination"},[e._t("pagination")],2):e._e()])])],1)],1)],1)},a=[],i={name:"TableLayout",props:{assideWidth:{type:String,default:"200px"},wrap:{type:Boolean,default:!0}}},o=i,l=(n("ce8d"),n("2877")),s=Object(l["a"])(o,r,a,!1,null,"549c5738",null);t["a"]=s.exports},fe2b:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-button",{attrs:{size:e.size,type:e.buttonType,disabled:e.disabled},on:{click:function(t){return t.stopPropagation(),e._handleClick.apply(null,arguments)}}},[e._t("default")],2)},a=[],i={name:"WarningConfirmButton",props:{content:{type:String,default:"此操作无法恢复，是否继续？"},title:{type:String,default:"警告"},confirmButtonText:{type:String,default:"确定"},cancelButtonText:{type:String,default:"取消"},iconType:{type:String,default:"warning",validator:function(e){return-1!==["success","info","warning","error"].indexOf(e)}},size:{type:String,default:"mini"},buttonType:{type:String,default:"text"},disabled:{type:Boolean,default:!1},closed:{type:Function,default:function(){return function(){}}},cancel:{type:Function,default:function(){return function(){}}}},data:function(){return{loading:!1}},methods:{_handleClick:function(){var e=this;this.$confirm(this.content,this.title,{confirmButtonText:this.confirmButtonText,cancelButtonText:this.cancelButtonText,type:this.iconType,beforeClose:function(t,n,r){"confirm"===t?(n.confirmButtonLoading=!0,e.$emit("confirm",{close:function(){n.confirmButtonLoading=!1,r()},done:function(){console.log(111),n.confirmButtonLoading=!1}})):(n.confirmButtonLoading=!1,r())}}).then((function(t){console.log(222),e.closed()})).catch((function(t){e.cancel()}))}}},o=i,l=n("2877"),s=Object(l["a"])(o,r,a,!1,null,null,null);t["a"]=s.exports}}]);